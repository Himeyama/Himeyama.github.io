---
title: NMF (HALS) の実装
layout: post
date: '2021-11-10 03:10'
---

```py
X = np.array([[1, 1], [2, 1], [3, 1.2], [4, 1], [5, 0.8], [6, 1]])
n, m, k = X.shape + (2, ) # X の行数列数とコンポーネント数
W = np.random.uniform(size = (n, k))
H = np.random.uniform(size = (k, m))

# NMF HALS
for i in range(100):
    # update B
    A = X.T.dot(W)
    B = W.T.dot(W)
    for j in range(k):
        H[j, :] = H[j, :] + A[:, j] - H.T.dot(B[:, j])

    # update A
    C = X.dot(H.T)
    D = H.dot(H.T)
    for j in range(k):
        W[:, j] = W[:, j] * D[j, j] + C[:, j] - W.dot(D[:, 0])
        W[:, j] = W[:, j] / np.linalg.norm(W[:, j])

print(X)
print(W.dot(H))
```

# 参考
- [Fast Local Algorithms for Large Scale Nonnegative Matrix and Tensor Factorizations](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.214.6398&rep=rep1&type=pdf)